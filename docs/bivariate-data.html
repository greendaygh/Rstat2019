<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Bivariate data | R로 배우는 기초통계</title>
  <meta name="description" content="이 강의는 2019년 2학기 UST에서 진행하는 일반강의 입니다." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Bivariate data | R로 배우는 기초통계" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="이 강의는 2019년 2학기 UST에서 진행하는 일반강의 입니다." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Bivariate data | R로 배우는 기초통계" />
  
  <meta name="twitter:description" content="이 강의는 2019년 2학기 UST에서 진행하는 일반강의 입니다." />
  

<meta name="author" content="한국생명공학연구원 김하성" />


<meta name="date" content="2019-10-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="univariat-data.html"/>
<link rel="next" href="multivariate-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> [2019 UST lecture] R statistics </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction 강의 개요</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#goal--"><i class="fa fa-check"></i><b>1.1</b> Goal 강의 목표</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#references--"><i class="fa fa-check"></i><b>1.2</b> References 참고 자료</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#evaluation---"><i class="fa fa-check"></i><b>1.3</b> Evaluation 평가 세부 항목</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#schedule--"><i class="fa fa-check"></i><b>1.4</b> Schedule 강의 계획</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references---1"><i class="fa fa-check"></i><b>1.5</b> References 참고 자료</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> R basics</a><ul>
<li class="chapter" data-level="2.1" data-path="r-basics.html"><a href="r-basics.html#what-is-r-rstudio"><i class="fa fa-check"></i><b>2.1</b> What is R / Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="r-basics.html"><a href="r-basics.html#r-rstudio-installation"><i class="fa fa-check"></i><b>2.2</b> R / Rstudio installation</a></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html#rstudio-interface"><i class="fa fa-check"></i><b>2.3</b> Rstudio interface</a></li>
<li class="chapter" data-level="2.4" data-path="r-basics.html"><a href="r-basics.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4</b> Keyboard shortcuts</a></li>
<li class="chapter" data-level="2.5" data-path="r-basics.html"><a href="r-basics.html#r-programming-basics-and-terminology"><i class="fa fa-check"></i><b>2.5</b> R programming basics and terminology</a></li>
<li class="chapter" data-level="2.6" data-path="r-basics.html"><a href="r-basics.html#set-working-directory"><i class="fa fa-check"></i><b>2.6</b> Set working directory</a></li>
<li class="chapter" data-level="2.7" data-path="r-basics.html"><a href="r-basics.html#r-coding-practice"><i class="fa fa-check"></i><b>2.7</b> R coding practice</a></li>
<li class="chapter" data-level="2.8" data-path="r-basics.html"><a href="r-basics.html#variables-and-values"><i class="fa fa-check"></i><b>2.8</b> Variables and values</a></li>
<li class="chapter" data-level="2.9" data-path="r-basics.html"><a href="r-basics.html#variable-type-of-storage-mode"><i class="fa fa-check"></i><b>2.9</b> Variable type of (storage) mode</a></li>
<li class="chapter" data-level="2.10" data-path="r-basics.html"><a href="r-basics.html#variable---vectors"><i class="fa fa-check"></i><b>2.10</b> Variable - Vectors</a></li>
<li class="chapter" data-level="2.11" data-path="r-basics.html"><a href="r-basics.html#functions"><i class="fa fa-check"></i><b>2.11</b> Functions</a></li>
<li class="chapter" data-level="2.12" data-path="r-basics.html"><a href="r-basics.html#vectorized-functions"><i class="fa fa-check"></i><b>2.12</b> Vectorized functions</a></li>
<li class="chapter" data-level="2.13" data-path="r-basics.html"><a href="r-basics.html#help"><i class="fa fa-check"></i><b>2.13</b> Help</a></li>
<li class="chapter" data-level="2.14" data-path="r-basics.html"><a href="r-basics.html#rstudio-workspace"><i class="fa fa-check"></i><b>2.14</b> RStudio workspace</a></li>
<li class="chapter" data-level="2.15" data-path="r-basics.html"><a href="r-basics.html#r-packages"><i class="fa fa-check"></i><b>2.15</b> R packages</a></li>
<li class="chapter" data-level="2.16" data-path="r-basics.html"><a href="r-basics.html#data-sets"><i class="fa fa-check"></i><b>2.16</b> Data sets</a></li>
<li class="chapter" data-level="2.17" data-path="r-basics.html"><a href="r-basics.html#cheatsheet"><i class="fa fa-check"></i><b>2.17</b> Cheatsheet</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="univariat-data.html"><a href="univariat-data.html"><i class="fa fa-check"></i><b>3</b> Univariat data</a><ul>
<li class="chapter" data-level="3.1" data-path="univariat-data.html"><a href="univariat-data.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="univariat-data.html"><a href="univariat-data.html#data-vectors"><i class="fa fa-check"></i><b>3.2</b> Data vectors</a></li>
<li class="chapter" data-level="3.3" data-path="univariat-data.html"><a href="univariat-data.html#data-type"><i class="fa fa-check"></i><b>3.3</b> Data type</a><ul>
<li class="chapter" data-level="3.3.1" data-path="univariat-data.html"><a href="univariat-data.html#example---recoding-values"><i class="fa fa-check"></i><b>3.3.1</b> Example - Recoding values</a></li>
<li class="chapter" data-level="3.3.2" data-path="univariat-data.html"><a href="univariat-data.html#example---average-distance-from-center"><i class="fa fa-check"></i><b>3.3.2</b> Example - Average distance from center</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="univariat-data.html"><a href="univariat-data.html#functions-1"><i class="fa fa-check"></i><b>3.4</b> Functions</a></li>
<li class="chapter" data-level="3.5" data-path="univariat-data.html"><a href="univariat-data.html#numeric-summaries"><i class="fa fa-check"></i><b>3.5</b> Numeric summaries</a></li>
<li class="chapter" data-level="3.6" data-path="univariat-data.html"><a href="univariat-data.html#center"><i class="fa fa-check"></i><b>3.6</b> Center</a><ul>
<li class="chapter" data-level="3.6.1" data-path="univariat-data.html"><a href="univariat-data.html#sample-mean"><i class="fa fa-check"></i><b>3.6.1</b> Sample mean</a></li>
<li class="chapter" data-level="3.6.2" data-path="univariat-data.html"><a href="univariat-data.html#measure-of-position"><i class="fa fa-check"></i><b>3.6.2</b> Measure of Position</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="univariat-data.html"><a href="univariat-data.html#spread"><i class="fa fa-check"></i><b>3.7</b> Spread</a></li>
<li class="chapter" data-level="3.8" data-path="univariat-data.html"><a href="univariat-data.html#shape"><i class="fa fa-check"></i><b>3.8</b> Shape</a></li>
<li class="chapter" data-level="3.9" data-path="univariat-data.html"><a href="univariat-data.html#viewing-the-shape"><i class="fa fa-check"></i><b>3.9</b> Viewing the shape</a></li>
<li class="chapter" data-level="3.10" data-path="univariat-data.html"><a href="univariat-data.html#categorical-data"><i class="fa fa-check"></i><b>3.10</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bivariate-data.html"><a href="bivariate-data.html"><i class="fa fa-check"></i><b>4</b> Bivariate data</a><ul>
<li class="chapter" data-level="4.1" data-path="bivariate-data.html"><a href="bivariate-data.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="4.1.1" data-path="bivariate-data.html"><a href="bivariate-data.html#independence-samples"><i class="fa fa-check"></i><b>4.1.1</b> Independence samples</a></li>
<li class="chapter" data-level="4.1.2" data-path="bivariate-data.html"><a href="bivariate-data.html#plot"><i class="fa fa-check"></i><b>4.1.2</b> plot</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bivariate-data.html"><a href="bivariate-data.html#data-manipulation"><i class="fa fa-check"></i><b>4.2</b> Data manipulation</a><ul>
<li class="chapter" data-level="4.2.1" data-path="bivariate-data.html"><a href="bivariate-data.html#list"><i class="fa fa-check"></i><b>4.2.1</b> List</a></li>
<li class="chapter" data-level="4.2.2" data-path="bivariate-data.html"><a href="bivariate-data.html#data-frame"><i class="fa fa-check"></i><b>4.2.2</b> Data frame</a></li>
<li class="chapter" data-level="4.2.3" data-path="bivariate-data.html"><a href="bivariate-data.html#model-formulas"><i class="fa fa-check"></i><b>4.2.3</b> Model formulas</a></li>
<li class="chapter" data-level="4.2.4" data-path="bivariate-data.html"><a href="bivariate-data.html#example-3-1"><i class="fa fa-check"></i><b>4.2.4</b> Example 3-1</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="bivariate-data.html"><a href="bivariate-data.html#paired-data"><i class="fa fa-check"></i><b>4.3</b> Paired data</a><ul>
<li class="chapter" data-level="4.3.1" data-path="bivariate-data.html"><a href="bivariate-data.html#pearson-correlation"><i class="fa fa-check"></i><b>4.3.1</b> Pearson Correlation</a></li>
<li class="chapter" data-level="4.3.2" data-path="bivariate-data.html"><a href="bivariate-data.html#spearman-correlation-coefficient"><i class="fa fa-check"></i><b>4.3.2</b> Spearman correlation coefficient</a></li>
<li class="chapter" data-level="4.3.3" data-path="bivariate-data.html"><a href="bivariate-data.html#correlation-causation-and-association"><i class="fa fa-check"></i><b>4.3.3</b> Correlation, causation and association</a></li>
<li class="chapter" data-level="4.3.4" data-path="bivariate-data.html"><a href="bivariate-data.html#trends"><i class="fa fa-check"></i><b>4.3.4</b> Trends</a></li>
<li class="chapter" data-level="4.3.5" data-path="bivariate-data.html"><a href="bivariate-data.html#the-method-of-least-squares"><i class="fa fa-check"></i><b>4.3.5</b> The method of least squares</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bivariate-data.html"><a href="bivariate-data.html#bivariate-categorical-data"><i class="fa fa-check"></i><b>4.4</b> Bivariate categorical data</a><ul>
<li class="chapter" data-level="4.4.1" data-path="bivariate-data.html"><a href="bivariate-data.html#contingency-tables"><i class="fa fa-check"></i><b>4.4.1</b> Contingency tables</a></li>
<li class="chapter" data-level="4.4.2" data-path="bivariate-data.html"><a href="bivariate-data.html#marginal-distributions"><i class="fa fa-check"></i><b>4.4.2</b> Marginal distributions</a></li>
<li class="chapter" data-level="4.4.3" data-path="bivariate-data.html"><a href="bivariate-data.html#conditional-distributions"><i class="fa fa-check"></i><b>4.4.3</b> Conditional distributions</a></li>
<li class="chapter" data-level="4.4.4" data-path="bivariate-data.html"><a href="bivariate-data.html#graphical-summaries-of-contingency-tables"><i class="fa fa-check"></i><b>4.4.4</b> Graphical summaries of contingency tables</a></li>
<li class="chapter" data-level="4.4.5" data-path="bivariate-data.html"><a href="bivariate-data.html#measures-of-association-for-categorical-data"><i class="fa fa-check"></i><b>4.4.5</b> Measures of association for categorical data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="bivariate-data.html"><a href="bivariate-data.html#homeworks"><i class="fa fa-check"></i><b>4.5</b> Homeworks</a><ul>
<li class="chapter" data-level="4.5.1" data-path="bivariate-data.html"><a href="bivariate-data.html#hw3-1"><i class="fa fa-check"></i><b>4.5.1</b> HW3-1</a></li>
<li class="chapter" data-level="4.5.2" data-path="bivariate-data.html"><a href="bivariate-data.html#hw3-2"><i class="fa fa-check"></i><b>4.5.2</b> HW3-2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-data.html"><a href="multivariate-data.html"><i class="fa fa-check"></i><b>5</b> Multivariate data</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-data.html"><a href="multivariate-data.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="multivariate-data.html"><a href="multivariate-data.html#data-structures-in-r"><i class="fa fa-check"></i><b>5.2</b> Data structures in R</a><ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-data.html"><a href="multivariate-data.html#vectors"><i class="fa fa-check"></i><b>5.2.1</b> Vectors</a></li>
<li class="chapter" data-level="5.2.2" data-path="multivariate-data.html"><a href="multivariate-data.html#lists"><i class="fa fa-check"></i><b>5.2.2</b> Lists</a></li>
<li class="chapter" data-level="5.2.3" data-path="multivariate-data.html"><a href="multivariate-data.html#matrices"><i class="fa fa-check"></i><b>5.2.3</b> Matrices</a></li>
<li class="chapter" data-level="5.2.4" data-path="multivariate-data.html"><a href="multivariate-data.html#data.frame"><i class="fa fa-check"></i><b>5.2.4</b> data.frame</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multivariate-data.html"><a href="multivariate-data.html#working-with-data-frame-i"><i class="fa fa-check"></i><b>5.3</b> Working with data frame I</a><ul>
<li class="chapter" data-level="5.3.1" data-path="multivariate-data.html"><a href="multivariate-data.html#some-exercises"><i class="fa fa-check"></i><b>5.3.1</b> some exercises</a></li>
<li class="chapter" data-level="5.3.2" data-path="multivariate-data.html"><a href="multivariate-data.html#subset-and-filter"><i class="fa fa-check"></i><b>5.3.2</b> subset and filter</a></li>
<li class="chapter" data-level="5.3.3" data-path="multivariate-data.html"><a href="multivariate-data.html#transforming"><i class="fa fa-check"></i><b>5.3.3</b> transforming</a></li>
<li class="chapter" data-level="5.3.4" data-path="multivariate-data.html"><a href="multivariate-data.html#reshaping"><i class="fa fa-check"></i><b>5.3.4</b> reshaping</a></li>
<li class="chapter" data-level="5.3.5" data-path="multivariate-data.html"><a href="multivariate-data.html#merging-data"><i class="fa fa-check"></i><b>5.3.5</b> merging data</a></li>
<li class="chapter" data-level="5.3.6" data-path="multivariate-data.html"><a href="multivariate-data.html#split"><i class="fa fa-check"></i><b>5.3.6</b> split</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multivariate-data.html"><a href="multivariate-data.html#working-with-data-frame-ii"><i class="fa fa-check"></i><b>5.4</b> working with data frame II</a><ul>
<li class="chapter" data-level="5.4.1" data-path="multivariate-data.html"><a href="multivariate-data.html#apply"><i class="fa fa-check"></i><b>5.4.1</b> apply</a></li>
<li class="chapter" data-level="5.4.2" data-path="multivariate-data.html"><a href="multivariate-data.html#map-and-apply-function-family"><i class="fa fa-check"></i><b>5.4.2</b> map and apply function family</a></li>
<li class="chapter" data-level="5.4.3" data-path="multivariate-data.html"><a href="multivariate-data.html#dplyr---pipe-operator"><i class="fa fa-check"></i><b>5.4.3</b> dplyr - pipe operator</a></li>
<li class="chapter" data-level="5.4.4" data-path="multivariate-data.html"><a href="multivariate-data.html#dplyr---important-functions"><i class="fa fa-check"></i><b>5.4.4</b> dplyr - Important functions</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R로 배우는 기초통계</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bivariate-data" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Bivariate data</h1>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>본 단원에서는 두 변수를 동시에 고려할 경우 각 변수가 가지고 있는 데이터를 비교하여 변수간의 유사성이나 관계 (상관, 독립)에 대한 설명하는 방법을 소개하며 짝데이터 (Paired data)나 범주형 데이터의 경우에 두 변수의 관계를 어떻게 설명하는지 알아봅니다. 또한 그래프를 이용하여 두 변수의 관계를 가시화 하는 방법에 대해 알아보겠습니다.</p>
<div id="independence-samples" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Independence samples</h3>
<p><img src="images/03/01.PNG" /></p>
<p>위 그림은 두 변수간 (x, y축) 관계를 산점도와 marginal histogram을 이용하여 비교한 그림 입니다. Marginal histogram은 두 그래프가 비슷한 모양을 하고 있지만 왼쪽 그림은 두 변수간 강한 양의 상관관계를 보여주고 있으며 오른쪽은 두 변수가 아무런 관계도 아닌 독립임을 보여줍니다.</p>
<p>두 변수간의 관계를 설명할 때 가장 일반적인 경우의 데이터 형태는 코흐트 데이터 입니다. 처리군과 대조군으로 이루어진 데이터를 말하며 플라시보 (Placebo effect) 효과를 방지하기 위해서 실제 효과는 없지만 대조군에 처리한 조건과 동일한 조건의 처리를 수행합니다.</p>
<pre class="sourceCode r" id="cb49"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">beets &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">41</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">44</span>, <span class="dv">35</span>, <span class="dv">41</span>, <span class="dv">36</span>, <span class="dv">47</span>, <span class="dv">45</span>)</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">no_beets &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">50</span>, <span class="dv">42</span>, <span class="dv">40</span>, <span class="dv">31</span>, <span class="dv">43</span>, <span class="dv">45</span>)</a></code></pre>
<p>위 데이터는 비트의 효과를 검증하기 위해 각 실험자의 달리는 시간을 측정하고 비교한 데이터 입니다. 이 데이터를 보고 알 수 있는 사실은 무엇이 있을까요? 우리가 앞서 단원에서 대푯값을 배웠으니 이를 고려해서 질문을 다시 생각해 봅시다.</p>
<ul>
<li>가장 오래 달린 세 명이 no beet 그룹에 있음</li>
<li>가장 적게 달린 한 사람이 beet 그룹에 있음</li>
<li>center, spread 또는 shape가 유사한가?</li>
</ul>
<p>이 후 단원에서 randomness가 가정된 상태에서 위 질문들에 대한 해답을 찾는 과정을 배우게 될 것입니다.</p>
</div>
<div id="plot" class="section level3">
<h3><span class="header-section-number">4.1.2</span> plot</h3>
<p>두 변수에 대한 관계를 가장 먼저 그리고 가장 직관적으로 설명하는 방법은 그래프 입니다. 줄기잎 차트나 <code>dot-plot</code> 등은 많이 쓰이지 않으나 <code>boxplot</code>과 산점도는 (<code>dot-plot</code>) 데이터 분석을 수행하기 전에 변수들간의 관계를 대략적으로 가늠해 볼 수 있기 때문에 많이 사용되고 있습니다.</p>
<pre class="sourceCode r" id="cb50"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">dotchart</span>(<span class="kw">c</span>(beets, no_beets))</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">dotchart</span>(<span class="kw">c</span>(beets, no_beets), <span class="dt">groups=</span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;beets&quot;</span>, <span class="kw">length</span>(beets)), <span class="kw">rep</span>(<span class="st">&quot;no_beets&quot;</span>, <span class="kw">length</span>(no_beets)))))</a></code></pre>
<p><code>boxplot</code>에서는 대략 다섯 가지 대표값을 볼 수 있습니다. 1사분위수, 2사분위수(중간값), 3사분위수, 그리고 최대, 최소값입니다. 여기서 최대 최소는 IQR 1.5배에 해당하는 하위 또는 상위 값으로 그 범위를 벗어나는 값들은 outlier로 취급합니다.</p>
<pre class="sourceCode r" id="cb51"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">boxplot</span>(beets, no_beets)</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"> <span class="kw">boxplot</span>(beets, no_beets, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;beets&quot;</span>, <span class="st">&quot;no_beets&quot;</span>))</a></code></pre>
<p><code>Density plot</code>은 histogram과 비슷하게 데이터의 center, spread, 그리고 shape를 모두 보여주는 높은 활용도 때문에 많이 사용되는 그래프 입니다. 지난 시간 <code>R</code>의 <code>density</code> 함수를 활용하여 그리는 방법을 간단히 알아본 바와 같이 density 함수는 밀도함수를 추정하고 주어진 범위의 x값과 그에 대한 y값을 반환해주며 plot 함수를 이용하여 x와 y위치에 점이나 선을 그려주어 그래프를 완성합니다.</p>
<pre class="sourceCode r" id="cb52"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">library</span>(UsingR)</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="kw">head</span>(michelson)</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">?michelson</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="kw">str</span>(michelson)</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">speed &lt;-<span class="st"> </span>michelson<span class="op">$</span>Speed </a>
<a class="sourceLine" id="cb52-6" data-line-number="6">expt &lt;-<span class="st"> </span>michelson<span class="op">$</span>Expt</a>
<a class="sourceLine" id="cb52-7" data-line-number="7">fourth &lt;-<span class="st"> </span>speed[expt <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]</a>
<a class="sourceLine" id="cb52-8" data-line-number="8">fifth &lt;-<span class="st"> </span>speed[expt <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb52-9" data-line-number="9">d4 &lt;-<span class="st"> </span><span class="kw">density</span>(fourth)</a>
<a class="sourceLine" id="cb52-10" data-line-number="10">d5 &lt;-<span class="st"> </span><span class="kw">density</span>(fifth)</a>
<a class="sourceLine" id="cb52-11" data-line-number="11">xrange &lt;-<span class="st"> </span><span class="kw">range</span>(<span class="kw">c</span>(d4<span class="op">$</span>x, d5<span class="op">$</span>x))</a>
<a class="sourceLine" id="cb52-12" data-line-number="12">yrange &lt;-<span class="st"> </span><span class="kw">range</span>(<span class="kw">c</span>(d4<span class="op">$</span>y, d5<span class="op">$</span>y))</a>
<a class="sourceLine" id="cb52-13" data-line-number="13"><span class="kw">plot</span>(d4, <span class="dt">xlim=</span>xrange, <span class="dt">ylim=</span>yrange, <span class="dt">xlab=</span><span class="st">&quot;densities&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb52-14" data-line-number="14"><span class="kw">lines</span>(d5, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-15" data-line-number="15"><span class="kw">legend</span>(<span class="dv">650</span>, <span class="fl">0.008</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Fourth&quot;</span>, <span class="st">&quot;Fifth&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre>
<pre class="sourceCode r" id="cb53"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw">plot</span>(fourth, fifth)</a></code></pre>
<p>QQplot은 두 변수가 갖는 데이터의 Quantile 값을 비교하는 그래프로 R의 <code>qqplot</code> 함수를 사용합니다.</p>
<pre class="sourceCode r" id="cb54"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">qqplot</span>(fourth, fifth)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">ps &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="dt">by=</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">quantile</span>(fourth, ps)</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="kw">quantile</span>(fifth, ps)</a>
<a class="sourceLine" id="cb54-5" data-line-number="5"><span class="kw">plot</span>(x, y)</a>
<a class="sourceLine" id="cb54-6" data-line-number="6"></a>
<a class="sourceLine" id="cb54-7" data-line-number="7">o &lt;-<span class="st"> </span><span class="kw">order</span>(fourth)</a>
<a class="sourceLine" id="cb54-8" data-line-number="8">fourth[o]</a>
<a class="sourceLine" id="cb54-9" data-line-number="9">fourth</a></code></pre>
</div>
</div>
<div id="data-manipulation" class="section level2">
<h2><span class="header-section-number">4.2</span> Data manipulation</h2>
<div id="list" class="section level3">
<h3><span class="header-section-number">4.2.1</span> List</h3>
<p>R언어에서 두 변수를 담을 수 있는 데이터 타입은 <code>list</code>와 <code>data frame</code> 두 종류가 있습니다. <code>list</code> 변수 타입은 <code>vector</code> 형태의 여러개의 element를 가질 수 있으며 각 element의 데이터는 문자나 숫자 어떤 데이터 타입도 가능하며 각 element vector의 길이가 모두 달라도 됩니다. list의 인덱싱에서 <code>[</code> <code>]</code>는 리스트를 반환하고 <code>[[</code> <code>]]</code>는 vector element들을 반환합니다.</p>
<pre class="sourceCode r" id="cb55"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">b &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">beets =</span> beets, <span class="st">&quot;no beets&quot;</span>=no_beets)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2">b<span class="op">$</span>beets</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">b[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb55-4" data-line-number="4">b[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="kw">class</span>(b[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb55-6" data-line-number="6"><span class="kw">class</span>(b[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb55-7" data-line-number="7"><span class="kw">boxplot</span>(b)</a></code></pre>
<p><img src="images/03/05.PNG" /></p>
</div>
<div id="data-frame" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Data frame</h3>
<p><code>data.frame</code> 타입 변수는 list와 같은 기능의 타입으로 볼 수 있지만 모든 element 들이 같은 길이를 갖는다는 것이 다릅니다. 따라서 2차원 메트릭스 형태로 표현될 수 있으며 matrix와 같이 <code>[가로, 세로]</code> 방식으로 인덱싱 할 수 있습니다. 각 row는 샘플을 나타내고 column은 하나의 변수를 타나냅니다. R 기반의 데이터 분석에서는 가장 선호되는 데이터 타입이라고 볼 수 있습니다.</p>
<pre class="sourceCode r" id="cb56"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2">name &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Name&quot;</span>, id, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb56-3" data-line-number="3">grade &lt;-<span class="st"> </span>LETTERS[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">size=</span><span class="kw">length</span>(id), <span class="dt">replace=</span>T)]</a>
<a class="sourceLine" id="cb56-4" data-line-number="4">student &lt;-<span class="st"> </span><span class="kw">data.frame</span>(id, name, grade)</a>
<a class="sourceLine" id="cb56-5" data-line-number="5">student</a>
<a class="sourceLine" id="cb56-6" data-line-number="6"></a>
<a class="sourceLine" id="cb56-7" data-line-number="7">student<span class="op">$</span>id</a>
<a class="sourceLine" id="cb56-8" data-line-number="8">student[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb56-9" data-line-number="9"><span class="kw">class</span>(student<span class="op">$</span>name)</a>
<a class="sourceLine" id="cb56-10" data-line-number="10"><span class="kw">str</span>(student)</a>
<a class="sourceLine" id="cb56-11" data-line-number="11"></a>
<a class="sourceLine" id="cb56-12" data-line-number="12"><span class="kw">class</span>(id)</a>
<a class="sourceLine" id="cb56-13" data-line-number="13"><span class="kw">class</span>(name)</a>
<a class="sourceLine" id="cb56-14" data-line-number="14"><span class="kw">class</span>(grade)</a>
<a class="sourceLine" id="cb56-15" data-line-number="15"><span class="kw">class</span>(student)</a>
<a class="sourceLine" id="cb56-16" data-line-number="16"><span class="kw">class</span>(student[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb56-17" data-line-number="17"><span class="kw">class</span>(student[,<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb56-18" data-line-number="18">student &lt;-<span class="st"> </span><span class="kw">data.frame</span>(id, name, grade, <span class="dt">stringsAsFactors =</span> F)</a></code></pre>
</div>
<div id="model-formulas" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Model formulas</h3>
<p>R에서는 두 변수의 관계를 수학적으로 표현하기 위한 방법을 제공하며 다양한 모형에서 공통적으로 사용될 수 있습니다.</p>
<p><span class="math display">\[ response(s) \sim predictor(s) \]</span></p>
<pre class="sourceCode r" id="cb57"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">head</span>(michelson)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">beets</a>
<a class="sourceLine" id="cb57-3" data-line-number="3">no_beets</a>
<a class="sourceLine" id="cb57-4" data-line-number="4">runtime &lt;-<span class="st"> </span><span class="kw">c</span>(beets, no_beets)</a>
<a class="sourceLine" id="cb57-5" data-line-number="5">nitrate &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;beets&quot;</span>, <span class="kw">length</span>(beets)), <span class="kw">rep</span>(<span class="st">&quot;nobeets&quot;</span>, <span class="kw">length</span>(no_beets)))</a>
<a class="sourceLine" id="cb57-6" data-line-number="6">food.sports &lt;-<span class="st"> </span><span class="kw">data.frame</span>(runtime, nitrate)</a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="kw">boxplot</span>(runtime<span class="op">~</span>nitrate, <span class="dt">data=</span>food.sports)</a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="kw">boxplot</span>(michelson<span class="op">$</span>Speed <span class="op">~</span><span class="st"> </span>michelson<span class="op">$</span>Expt)</a>
<a class="sourceLine" id="cb57-9" data-line-number="9"><span class="kw">boxplot</span>(Speed <span class="op">~</span><span class="st"> </span>Expt, <span class="dt">data=</span>michelson)</a></code></pre>
<p>R에서 <code>plot</code>함수는 <code>Generic function</code>으로서 입력 파라메터가 갖는 데이터 타입에 따라서 다른 기능을 수행할 수 있습니다. 예를 들어 <code>formula type</code>으로 <span class="math inline">\(x \sim f\)</span> 가 들어갈 경우 그룹별로 boxplot을 나란히 그려주며 따라서 그룹별로 데이터가 얼마나 다른지 한 눈에 비교할 수 있습니다.</p>
<pre class="sourceCode r" id="cb58"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">plot</span>(Speed <span class="op">~</span><span class="st"> </span>Expt, <span class="dt">data=</span>michelson)</a>
<a class="sourceLine" id="cb58-2" data-line-number="2">out &lt;-<span class="st"> </span><span class="kw">summary</span>(Speed <span class="op">~</span><span class="st"> </span>Expt, <span class="dt">data=</span>michelson)</a>
<a class="sourceLine" id="cb58-3" data-line-number="3"><span class="kw">plot</span>(out)</a>
<a class="sourceLine" id="cb58-4" data-line-number="4"><span class="kw">plot</span>(michelson<span class="op">$</span>Speed)</a>
<a class="sourceLine" id="cb58-5" data-line-number="5"><span class="kw">plot</span>(michelson<span class="op">$</span>Speed, <span class="dt">main=</span><span class="st">&quot;Speed&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Speed&quot;</span>, <span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">pch=</span><span class="st">&quot;*&quot;</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb58-6" data-line-number="6">?pch</a></code></pre>
<p><img src="images/03/03.PNG" /></p>
<p><img src="images/03/04.PNG" /></p>
<p>Stack 함수는 관측 값을 하나의 벡터로 만들고 각 벡터의 라벨을 또 하나의 벡터로 만들어서 합해주는 기능을 수행합니다. 이는 다음에 배울 reshape2 패키지의 melt 와 비슷한 기능을 하고 있습니다.</p>
<p>Split 함수의 경우 data를 정의된 그룹으로 나누고 list 타입으로 반환해줍니다. 그룹은 factor 형으로 정의된 변수에 저장되어 있어야 합니다.</p>
<pre class="sourceCode r" id="cb59"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">str</span>(twins)</a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="kw">boxplot</span>(<span class="kw">data.frame</span>(twins<span class="op">$</span>Foster, twins<span class="op">$</span>Biological))</a></code></pre>
<pre class="sourceCode r" id="cb60"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">b &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;beets&quot;</span> =<span class="st"> </span>beets, <span class="st">&quot;no beets&quot;</span> =<span class="st"> </span>no_beets)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2">stacked &lt;-<span class="st"> </span><span class="kw">stack</span>(b)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3"><span class="kw">plot</span>(values <span class="op">~</span><span class="st"> </span>ind, <span class="dt">data=</span>stacked)</a>
<a class="sourceLine" id="cb60-4" data-line-number="4"></a>
<a class="sourceLine" id="cb60-5" data-line-number="5">?split</a>
<a class="sourceLine" id="cb60-6" data-line-number="6">speeds &lt;-<span class="st"> </span><span class="kw">split</span>(michelson<span class="op">$</span>Speed, michelson<span class="op">$</span>Expt)</a>
<a class="sourceLine" id="cb60-7" data-line-number="7"><span class="kw">names</span>(speeds) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Expt&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb60-8" data-line-number="8">speeds</a>
<a class="sourceLine" id="cb60-9" data-line-number="9"></a>
<a class="sourceLine" id="cb60-10" data-line-number="10">speed &lt;-<span class="st"> </span>michelson<span class="op">$</span>Speed</a>
<a class="sourceLine" id="cb60-11" data-line-number="11">expt &lt;-<span class="st"> </span>michelson<span class="op">$</span>Expt</a>
<a class="sourceLine" id="cb60-12" data-line-number="12">speed</a>
<a class="sourceLine" id="cb60-13" data-line-number="13">expt</a>
<a class="sourceLine" id="cb60-14" data-line-number="14">speeds &lt;-<span class="st"> </span><span class="kw">list</span>(speed[expt<span class="op">==</span><span class="dv">1</span>], speed[expt<span class="op">==</span><span class="dv">2</span>], speed[expt<span class="op">==</span><span class="dv">3</span>], speed[expt<span class="op">==</span><span class="dv">4</span>], speed[expt<span class="op">==</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb60-15" data-line-number="15"><span class="kw">names</span>(speeds) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Expt&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb60-16" data-line-number="16">speeds</a></code></pre>
</div>
<div id="example-3-1" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Example 3-1</h3>
<ul>
<li>다음 데이터를 list 타입의 변수를 이용해서 저장하시오
<ul>
<li>marsha: 25, 0, 45, 90, 0</li>
<li>bill: 30, 30, 30, 30</li>
<li>holly: 15, 0, 90, 0</li>
</ul></li>
<li><code>Hmisc</code> 패키지를 읽고 michelson 데이터를 <code>Speed ~ Expt</code> model formular 를 사용해서 어떤 ouput이 나오는지 설명하시오</li>
</ul>
<pre class="sourceCode r" id="cb61"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">library</span>(Hmisc)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">michelson</a>
<a class="sourceLine" id="cb61-3" data-line-number="3"></a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="kw">summary</span>(Speed<span class="op">~</span>Expt, michelson)</a></code></pre>
<ul>
<li>twins 데이터에서 Foster와 Biological 데이터에 대한 boxplot을 그리고 두 데이터의 center와 spread를 비교하시오</li>
</ul>
</div>
</div>
<div id="paired-data" class="section level2">
<h2><span class="header-section-number">4.3</span> Paired data</h2>
<p>paired data는 두 종류의 변수에 대한 데이터를 하나의 샘플로 부터 얻을 때의 데이터를 말합니다. 본 단원에서 두 변수의 데이터형은 연속형과 연속형, 또는 연속형과 범주형의 경우로 다음 단원에서 범주형과 범주형에 대한 경우의 두 변수간 관계를 설명하겠습니다.</p>
<p>예를 들어 한 학생으로부터 얻어진 키와 몸무게 데이터가 paired data가 될 수 있습니다. paired data는 보통 다음과 같은 형태를 취하고 있습니다.</p>
<p><span class="math display">\[ (x_1, y_1), (x_2, y_2), ..., (x_{252}, y_{252})  \]</span></p>
<p>걸리버 여행기라는 (1726) 소설이 나올 무렵의 사람들은 손목과 목, 허리 둘래가 항상 일정 비율로 비례하는 것을 알고 있었는데 이를 Lilliputians’ hypothesis라고 합니다. 이를 fat 데이터를 통해 알아 봅니다.</p>
<p><img src="images/03/02.png" /></p>
<p><code>UsingR</code> 패키지의 <code>fat</code> 데이터는 252명의 남성으로부터 얻어진 다른 신체 부위의 측정 값을 제공하고 있으며 fat index를 예측하기 위한 목적으로 사용될 수 있습니다. 본 강의에서는 neck과 wrist 두 변수간의 관계를 설명하기 위한 데이터로 사용됩니다.</p>
<pre class="sourceCode r" id="cb62"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">library</span>(UsingR)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2"><span class="kw">class</span>(fat)</a>
<a class="sourceLine" id="cb62-3" data-line-number="3"><span class="kw">head</span>(fat)</a>
<a class="sourceLine" id="cb62-4" data-line-number="4"><span class="kw">names</span>(fat)</a>
<a class="sourceLine" id="cb62-5" data-line-number="5"></a>
<a class="sourceLine" id="cb62-6" data-line-number="6">neck_pair &lt;-<span class="st"> </span>fat<span class="op">$</span>neck</a>
<a class="sourceLine" id="cb62-7" data-line-number="7">wrist_pair &lt;-<span class="st"> </span>fat<span class="op">$</span>wrist</a>
<a class="sourceLine" id="cb62-8" data-line-number="8"><span class="kw">mean</span>(neck_pair<span class="op">/</span>wrist_pair)</a>
<a class="sourceLine" id="cb62-9" data-line-number="9"><span class="kw">mean</span>(neck_pair)<span class="op">/</span><span class="kw">mean</span>(wrist_pair)</a>
<a class="sourceLine" id="cb62-10" data-line-number="10"><span class="kw">plot</span>(neck_pair, wrist_pair)</a></code></pre>
<p>손목과 목 둘레를 측정한 데이터의 대표값 (평군)을 이용하여 두 변수 사이의 비율을 계산해 보면 2.084로 거의 두 배의 비율을 보입니다. 짝 데이터가 아닌 경우의 비율은 어떻게 될지 계산해 보면 아래와 같이 2.08로 비슷한 값이 구해집니다. 그러나 plot을 사용해서 산점도를 그려보면 nopair 데이터의 경우 두 변수의 상관성이 사라지는 것을 알 수 있습니다.</p>
<pre class="sourceCode r" id="cb63"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">neck_nopair &lt;-<span class="kw">sample</span>(fat<span class="op">$</span>neck)</a>
<a class="sourceLine" id="cb63-2" data-line-number="2">wrist_nopair &lt;-<span class="st"> </span><span class="kw">sample</span>(fat<span class="op">$</span>wrist)</a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="kw">mean</span>(neck_nopair)<span class="op">/</span><span class="kw">mean</span>(wrist_nopair)</a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="kw">mean</span>(neck_nopair<span class="op">/</span>wrist_nopair)</a>
<a class="sourceLine" id="cb63-5" data-line-number="5"><span class="kw">plot</span>(neck_nopair, wrist_nopair)</a></code></pre>
<div id="pearson-correlation" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Pearson Correlation</h3>
<p><code>상관</code> 또는 <code>상관계수</code>는 두 변수의 선형적 관계를 정량적으로 나타내는 척도입니다. 상관계수의 값이 <code>0</code>일 경우 두 변수는 <code>독립 (independence)</code>이라고 할 수 있고 선형 관계에 대해서만 사용됩니다.</p>
<pre class="sourceCode r" id="cb64"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">x &lt;-<span class="st"> </span>fat<span class="op">$</span>wrist</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">y &lt;-<span class="st"> </span>fat<span class="op">$</span>neck</a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="kw">plot</span>(x, y)</a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(x), <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb64-5" data-line-number="5"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(y), <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb64-6" data-line-number="6"><span class="kw">points</span>(<span class="kw">mean</span>(x), <span class="kw">mean</span>(y), <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="dv">4</span>, <span class="dt">col=</span><span class="st">&quot;#00000055&quot;</span>)</a>
<a class="sourceLine" id="cb64-7" data-line-number="7"><span class="kw">abline</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))</a></code></pre>
<p>공분산 (covariance)와 상관 (correlation)은 데이터의 중앙을 기준으로 4개의 구역에 각 데이터가 흩어진 정도를 정량화 한 것이며 다음과 같이 정의됩니다.</p>
<p><span class="math display">\[ cov(x, y) = \frac{1}{n-1} \sum{(x_i-\bar{x})(y_i-\bar{y})} \]</span></p>
<p><span class="math display">\[ cor(x, y) = \frac{1}{n-1} \sum{(\frac{x_i-\bar{x}}{s_x})(\frac{y_i-\bar{y}}{s_y})} = cov(x,y)/(s_x s_y)\]</span></p>
<pre class="sourceCode r" id="cb65"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">cor</span>(fat<span class="op">$</span>wrist, fat<span class="op">$</span>neck)</a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="kw">cor</span>(fat<span class="op">$</span>wrist, fat<span class="op">$</span>height)</a>
<a class="sourceLine" id="cb65-3" data-line-number="3"><span class="kw">cor</span>(fat<span class="op">$</span>age, fat<span class="op">$</span>ankle)</a></code></pre>
</div>
<div id="spearman-correlation-coefficient" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Spearman correlation coefficient</h3>
<p>피어슨 상관계수는 선형적 관계에 대한 정량화만 가능한 반면 spearman 상관계수는 선형관계 뿐만 아니라 비선형 적인 관계에 대해서도 단조 증가나 감소에 대한 정보를 측정할 수 있는 measure 입니다. 이는 데이터의 값 자체를 사용하기 보다는 데이터를 rank 값으로 변환한 후 상관성을 비교하기 때문에 가능한 기능입니다.</p>
<div class="figure">
<img src="images/03/07.PNG" alt="from wiki" />
<p class="caption">from wiki</p>
</div>
<pre class="sourceCode r" id="cb66"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">x &lt;-<span class="st"> </span>Animals<span class="op">$</span>body</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">y &lt;-<span class="st"> </span>Animals<span class="op">$</span>brain</a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="kw">cor</span>(x, y)</a>
<a class="sourceLine" id="cb66-4" data-line-number="4"><span class="kw">plot</span>(x, y)</a>
<a class="sourceLine" id="cb66-5" data-line-number="5">Animals</a>
<a class="sourceLine" id="cb66-6" data-line-number="6"><span class="kw">cor</span>(<span class="kw">rank</span>(x), <span class="kw">rank</span>(y))</a>
<a class="sourceLine" id="cb66-7" data-line-number="7"><span class="kw">cor</span>(x, y, <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>) </a></code></pre>
<p>Animals 데이터에서 correlation 값이 낮은 이유는 공룡과 같이 뇌 무게에 비해 비정상적으로 큰 몸무게 값을 갖는 개체들 때문입니다.</p>
<ul>
<li>Example: 공룡을 제외한 correlation을 구하시오</li>
</ul>
<p>일반적으로 분석의 신뢰성을 높이기 위해 실험 반복을 통해 데이터를 수집합니다. 그런데 가끔은 전체 반복 데이터를 모두 사용해서 상관계수를 구하는 값보다 각 반복 데이터의 평균에 대한 상관 계수를 구랗 때 더 높은 상관 관계를 확인할 수 있습니다.</p>
<pre class="sourceCode r" id="cb67"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">ToothGrowth</a>
<a class="sourceLine" id="cb67-2" data-line-number="2"></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"><span class="kw">plot</span>(ToothGrowth<span class="op">$</span>dose, ToothGrowth<span class="op">$</span>len)</a>
<a class="sourceLine" id="cb67-4" data-line-number="4"><span class="kw">cor</span>(ToothGrowth<span class="op">$</span>dose, ToothGrowth<span class="op">$</span>len)</a>
<a class="sourceLine" id="cb67-5" data-line-number="5">l &lt;-<span class="st"> </span><span class="kw">split</span>(ToothGrowth<span class="op">$</span>len, ToothGrowth<span class="op">$</span>dose)</a>
<a class="sourceLine" id="cb67-6" data-line-number="6">group_means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(l[[<span class="dv">1</span>]]), <span class="kw">mean</span>(l[[<span class="dv">2</span>]]), <span class="kw">mean</span>(l[[<span class="dv">3</span>]]))</a>
<a class="sourceLine" id="cb67-7" data-line-number="7"></a>
<a class="sourceLine" id="cb67-8" data-line-number="8"><span class="kw">points</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>), group_means, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">17</span>, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb67-9" data-line-number="9"><span class="kw">cor</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>), group_means)</a></code></pre>
</div>
<div id="correlation-causation-and-association" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Correlation, causation and association</h3>
<p>상관성 분석 중 유의할 점 중 하나는 상관성이 인과 관계를 의미하지 않는 다는 점 입니다. Smoking vs. cancer (1950) 연구의 경우 폐암 발병의 원인으로 담배에 대한 입장이 Industry 입장에서의 견해와 health care researchers 입장에서 견해가 다를 수 있습니다. <code>Lurking variables</code> 또는 <code>compounding effect</code>라고 불리우는 효과는 원인과 결과가 되는 두 요소에 모두 상관성을 갖는 변수로서 당시 담배가 폐암에 원인인지 아닌지에 대한 논란을 일으켰습니다.</p>
<p>Simpson’s paradox 현상은 전체 데이터의 상관성이 하위 그룹별로 고려한 상관성과 반대가 되는 경우를 말합니다.</p>
<pre class="sourceCode r" id="cb68"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">cor</span>(SAT<span class="op">$</span>salary, SAT<span class="op">$</span>total)</a>
<a class="sourceLine" id="cb68-2" data-line-number="2"><span class="kw">plot</span>(salary<span class="op">~</span>total, <span class="dt">data=</span>SAT, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="kw">points</span>(salary<span class="op">~</span>total, SAT, <span class="dt">subset =</span> perc <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>,  <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">15</span>, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb68-4" data-line-number="4"><span class="kw">points</span>(salary<span class="op">~</span>total, SAT, <span class="dt">subset =</span> perc <span class="op">&gt;</span><span class="st"> </span><span class="dv">40</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb68-5" data-line-number="5"><span class="kw">abline</span>(<span class="kw">lm</span>(SAT<span class="op">$</span>salary<span class="op">~</span>SAT<span class="op">$</span>total))</a>
<a class="sourceLine" id="cb68-6" data-line-number="6"><span class="kw">abline</span>(<span class="kw">lm</span>(salary<span class="op">~</span>total, SAT, <span class="dt">subset =</span> perc <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>),  <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb68-7" data-line-number="7"><span class="kw">abline</span>(<span class="kw">lm</span>(salary<span class="op">~</span>total, SAT, <span class="dt">subset =</span> perc <span class="op">&gt;</span><span class="st"> </span><span class="dv">40</span>),  <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre>
<p>반응변수 y와 설명변수 x의 관계는 다음 그림과 같은 경우의 수를 생각할 수 있습니다.</p>
<div class="figure">
<img src="images/03/08.PNG" alt="UsingR" />
<p class="caption">UsingR</p>
</div>
<p>직접적 원인에 의한 결과를 설명하는 인과관계로 설명이 어렬울 경우 좀 더 넓은 범위의 연관성(Association) 으로 두 변수가 관련이 있음을 표현하는 것도 하나의 방법입니다. 1996년 오스트레일리아의 총기 소유자들에게 총기를 다시 사들이는 정부 정책과 자살율에 관한 연구가 그 예제 입니다.</p>
</div>
<div id="trends" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Trends</h3>
<p>앞서 상관계수는 두 (연속형) 변수간의 관계를 나타내는 척도라고 설명을 했습니다. 하나의 변수는 연속형이고 다른 변수가 범주형 변수일 경우에도 각 범주형 변수의 그룹이 값는 평균값을 비교하여 관계를 유추할 수 있습니다. 즉, 각 그룹의 평균값들을 선으로 연결하였을 때 그 기울기가 일정하면 그룹의 변화에 따른 반응값이 선형적으로 일정한 관계에 있다고 해석할 수 있습니다. 선형적 트렌드는 다음과 같은 모형으로 나타낼 수 있습니다.</p>
<p><span class="math display">\[ \mu_{y|x} = \beta_0 + \beta_1 x \]</span></p>
<p>여기서 <span class="math inline">\(\mu_{y|x}\)</span> 는 설명변수 <span class="math inline">\(x\)</span> 가 주어진 상태에서 반응변수의 평균으로 볼 수 있습니다. 각 데이터포인트의 경우 <span class="math display">\[y_i = \beta_0 + \beta_1 x_i + e_i\]</span> 이며 <span class="math inline">\(e_i\)</span>는 에러를 나타냅니다. <span class="math inline">\(\beta\)</span> 값들은 계산을 해야 알 수 있지만 0일 경우 <span class="math inline">\(y\)</span> 값은 항상 일정하고 에러의 평균은 0이 됨을 가정하고 있습니다.</p>
<p>이제 <span class="math inline">\(\beta\)</span>가 0인지 아닌지를 계산하면 두 변수가 연관이 있는지에 대한 판단을 할 수 있습니다. <span class="math inline">\(\beta\)</span>를 구하기 전에 우선 <code>error</code>, <code>residual</code>, 그리고 <code>bias</code> 에 대한 념을 정확히 알아두는 것이 좋습니다.</p>
<p><img src="images/03/09.PNG" /></p>
</div>
<div id="the-method-of-least-squares" class="section level3">
<h3><span class="header-section-number">4.3.5</span> The method of least squares</h3>
<p>정의에 의해서 잔차는 다음과 같습니다. 즉 잔차는 관측값에서 추정된값과의 차이입니다.</p>
<p><span class="math display">\[ \hat{y}_i = b_0 + b_1 x_i \]</span>
<span class="math display">\[ residual = y_i - \hat{y}_i \]</span></p>
<p><span class="math inline">\(\beta\)</span> 값은 최소제곱추정법이라는 방법으로 구할 수 있는데 이 방법은 각 점에서의 잔차를 최소화 하는 선분을 (회귀선) 구하는 과정이며 <span class="math inline">\(\beta\)</span>는 해당 선분의 기울기로 볼 수 있습니다. 즉, 추정에 의해서 구해진 회귀선은 <code>squared residual</code>을 최소화 하는 선분이라고 해석할 수 있습니다.</p>
<p><img src="images/03/10.PNG" /></p>
<p>선분 <span class="math inline">\(\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x\)</span>의 최소 제곱법에 의한 <span class="math inline">\(\beta_0\)</span>와 <span class="math inline">\(\beta_1\)</span>의 추정값 <span class="math inline">\(\hat{\beta}_0\)</span>와 <span class="math inline">\(\hat{\beta}_1\)</span>은 다음과 같이 정의 됩니다.</p>
<p><span class="math display">\[ \hat{\beta}_1 = \frac{\sum(x_i - \bar{x})(y_i-\bar{y})}{\sum(x_i - \bar{x})^2} = cor(x,y)\frac{s_y}{s_x}\]</span></p>
<p><span class="math display">\[ \hat{\beta}_0 = \hat{y} - \hat{\beta}_1 x \]</span></p>
<p>위 두 식에서 회귀선분의 기울기인 <span class="math inline">\(\hat{\beta}_1\)</span>은 상관계수에 <span class="math inline">\(s_y / s_x\)</span>를 곱한 수로 1만큼 x 축으로 변할 때 변화하는 y 값의 평균 변화량으로 해석하면 되겠습니다. 또한 상관계수와는 달리 설명변수와 반응변수인 <span class="math inline">\(x\)</span>와 <span class="math inline">\(y\)</span>가 바뀔경우 값이 달라지며 여전히 잔차의 합은 0가 됩니다. R에서는 다음과 같이 <code>lm</code> 함수를 사용하며 이 함수에 대한 더 자세한 내용은 11장에서 다시 배우게 되겠습니다.</p>
<pre class="sourceCode r" id="cb69"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">?lm</a>
<a class="sourceLine" id="cb69-2" data-line-number="2">out &lt;-<span class="st"> </span><span class="kw">lm</span>(maxrate <span class="op">~</span><span class="st"> </span>age, <span class="dt">data=</span>heartrate)</a>
<a class="sourceLine" id="cb69-3" data-line-number="3">out</a>
<a class="sourceLine" id="cb69-4" data-line-number="4"></a>
<a class="sourceLine" id="cb69-5" data-line-number="5">## visualize fitted line</a>
<a class="sourceLine" id="cb69-6" data-line-number="6"><span class="kw">names</span>(out)</a>
<a class="sourceLine" id="cb69-7" data-line-number="7"><span class="kw">summary</span>(out)</a>
<a class="sourceLine" id="cb69-8" data-line-number="8"><span class="kw">plot</span>(maxrate <span class="op">~</span><span class="st"> </span>age, <span class="dt">data=</span>heartrate)</a>
<a class="sourceLine" id="cb69-9" data-line-number="9"><span class="kw">abline</span>(out)</a>
<a class="sourceLine" id="cb69-10" data-line-number="10"></a>
<a class="sourceLine" id="cb69-11" data-line-number="11">## residuals</a>
<a class="sourceLine" id="cb69-12" data-line-number="12"><span class="kw">sum</span>(<span class="kw">resid</span>(out))</a>
<a class="sourceLine" id="cb69-13" data-line-number="13"><span class="kw">sum</span>(out<span class="op">$</span>residuals)</a>
<a class="sourceLine" id="cb69-14" data-line-number="14">res &lt;-<span class="st"> </span>heartrate<span class="op">$</span>maxrate <span class="op">-</span><span class="st"> </span>out<span class="op">$</span>fitted.values</a>
<a class="sourceLine" id="cb69-15" data-line-number="15"><span class="kw">sum</span>(res)</a>
<a class="sourceLine" id="cb69-16" data-line-number="16"></a>
<a class="sourceLine" id="cb69-17" data-line-number="17">## fitted values</a>
<a class="sourceLine" id="cb69-18" data-line-number="18">age &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb69-19" data-line-number="19">out<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>out<span class="op">$</span>coefficients[<span class="dv">2</span>]<span class="op">*</span>age</a>
<a class="sourceLine" id="cb69-20" data-line-number="20"><span class="kw">predict</span>(out, <span class="kw">data.frame</span>(age))</a>
<a class="sourceLine" id="cb69-21" data-line-number="21"><span class="kw">head</span>(heartrate)</a>
<a class="sourceLine" id="cb69-22" data-line-number="22"><span class="kw">predict</span>(out, <span class="kw">data.frame</span>(<span class="dt">age=</span><span class="dv">30</span>))</a></code></pre>
<ul>
<li><p>Example: fit 데이터에서 abdomen 과 wrist의 산점도를 그리고 선형모형을 적합한 후 추세선을 그리시오. 17cm wrist 크기를 갖는 사람은 얼마의 abdomen의 값을 가질지 예측하시오.</p></li>
<li><p>correlation vs. association vs. relation</p></li>
</ul>
<div class="figure">
<img src="images/03/13.PNG" alt="https://stats.stackexchange.com/questions/371747/association-relationship-and-correlation" />
<p class="caption"><a href="https://stats.stackexchange.com/questions/371747/association-relationship-and-correlation" class="uri">https://stats.stackexchange.com/questions/371747/association-relationship-and-correlation</a></p>
</div>
<p><img src="images/03/14.png" /></p>
</div>
</div>
<div id="bivariate-categorical-data" class="section level2">
<h2><span class="header-section-number">4.4</span> Bivariate categorical data</h2>
<p>이번 단원에서는 두 종류의 짝데이터가 모두 범주형일 경우에 그 연관성을 정량화하는 방법에 대해서 알아보겠습니다.</p>
<div id="contingency-tables" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Contingency tables</h3>
<p>일반적으로 범주형 데이터는 각 샘플의 그룹 정보를 표시하여 나타내며 분석을 위해서는 이러한 그룹 정보를 기준으로 각 그룹에 해당하는 샘플의 갯수를 카운팅하여 contingency table로 변환하여 분석을 수행하게 됩니다. 두 범주형 변수의 경우는 two-way contingency table로 나타낼 수 있습니다.</p>
<p><img src="images/03/11.PNG" /></p>
<p>R에서는 다음과 같은 다양한 방법으로 테이블을 만듭니다.</p>
<pre class="sourceCode r" id="cb70"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">56</span>,<span class="dv">8</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">16</span>))</a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">56</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">16</span>))</a>
<a class="sourceLine" id="cb70-3" data-line-number="3"></a>
<a class="sourceLine" id="cb70-4" data-line-number="4">seatbelts &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">56</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">16</span>), <span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-5" data-line-number="5"><span class="kw">rownames</span>(seatbelts) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;buckled&quot;</span>,<span class="st">&quot;unbuckled&quot;</span>)</a>
<a class="sourceLine" id="cb70-6" data-line-number="6"><span class="kw">colnames</span>(seatbelts) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;buckled&quot;</span>,<span class="st">&quot;unbuckled&quot;</span>)</a>
<a class="sourceLine" id="cb70-7" data-line-number="7">seatbelts</a>
<a class="sourceLine" id="cb70-8" data-line-number="8"></a>
<a class="sourceLine" id="cb70-9" data-line-number="9"><span class="kw">rownames</span>(seatbelts) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;pa_buckled&quot;</span>,<span class="st">&quot;pa_unbuckled&quot;</span>)</a>
<a class="sourceLine" id="cb70-10" data-line-number="10"><span class="kw">colnames</span>(seatbelts) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ch_buckled&quot;</span>,<span class="st">&quot;ch_unbuckled&quot;</span>)</a>
<a class="sourceLine" id="cb70-11" data-line-number="11">seatbelts</a>
<a class="sourceLine" id="cb70-12" data-line-number="12"></a>
<a class="sourceLine" id="cb70-13" data-line-number="13"><span class="kw">dimnames</span>(seatbelts) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">parent=</span><span class="kw">c</span>(<span class="st">&quot;buckled&quot;</span>,<span class="st">&quot;unbuckled&quot;</span>),</a>
<a class="sourceLine" id="cb70-14" data-line-number="14"><span class="dt">child=</span><span class="kw">c</span>(<span class="st">&quot;buckled&quot;</span>,<span class="st">&quot;unbuckled&quot;</span>))</a>
<a class="sourceLine" id="cb70-15" data-line-number="15">seatbelts</a></code></pre>
<pre class="sourceCode r" id="cb71"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">head</span>(grades)</a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="kw">str</span>(grades)</a>
<a class="sourceLine" id="cb71-3" data-line-number="3">mytbl &lt;-<span class="st"> </span><span class="kw">table</span>(grades<span class="op">$</span>prev, grades<span class="op">$</span>grade)</a></code></pre>
</div>
<div id="marginal-distributions" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Marginal distributions</h3>
<p>연관성을 정량화 하기 전에 알아야할 두 가지 개념 중 하나는 주변분포 (marginal distribution)이고 다른 하나는 조건부분포 (conditional distributoin) 입니다. two-way 테이블은 두 개의 변수에 대한 요약 정보를 나타내며 각 변수들의 분표를 독립적으로 정량화 한 경우를 주변분포라고 합니다. R에서는 <code>colSums</code>, <code>rowSums</code> 또는 <code>margin.table</code>을 이용하여 계산 할 수 있습니다.</p>
<pre class="sourceCode r" id="cb72"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">mytbl</a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="kw">rowSums</span>(mytbl)</a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="kw">margin.table</span>(mytbl, <span class="dt">margin=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb72-4" data-line-number="4"></a>
<a class="sourceLine" id="cb72-5" data-line-number="5"><span class="kw">colSums</span>(mytbl)</a>
<a class="sourceLine" id="cb72-6" data-line-number="6"><span class="kw">margin.table</span>(mytbl, <span class="dt">margin=</span><span class="dv">2</span>)</a></code></pre>
</div>
<div id="conditional-distributions" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Conditional distributions</h3>
<p>조건부 분포는 위 분할표 (contingency table)의 하나의 row에 대해서 다른 row와 비교하는 경우를 생각하면 됩니다. 즉 위 안전벨트 데이터에서 부모가 벨트를 맬 경우와 매지 않을 경우 각각에 대한 아이들의 벨트 착용 비율을 말합니다.</p>
<p><span class="math display">\[ p(C=b|P=b) = \frac{p(C=b, P=b)}{p(P=b)} \]</span></p>
<p>R에서는 Marginal 분포 값으로 각 해당하는 cell의 값을 나누어 비율을 계산할 수 있습니다. Seatbelt 데이터의 경우 부모가 벨트를 착용할 경우 아이들이 착용하는 비율이 0.875이고 부모가 착용하지 않을 때 아이들이 착용하는 비율은 0.11로 차이가 보임을 알 수 있습니다.</p>
<pre class="sourceCode r" id="cb73"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">prop.table</span>(seatbelts)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2">seatbelts<span class="op">/</span><span class="kw">sum</span>(seatbelts)</a>
<a class="sourceLine" id="cb73-3" data-line-number="3"></a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="kw">prop.table</span>(seatbelts, <span class="dt">margin=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb73-5" data-line-number="5"><span class="kw">prop.table</span>(seatbelts, <span class="dt">margin=</span><span class="dv">2</span>)</a></code></pre>
<p>R 이 제공하는 <code>xtabs</code> 함수를 사용하면 위와 같은 계산을 쉽게 할 수 있습니다. 다음 Fingerprints 데이터는 whorls 와 Loops의 갯수의 조합에 해당하는 사람들의 수를 세어놓은 데이터입니다. <code>NA</code>를 제외하고 테이블을 만들기 위해서는 각 카테고리별로 테이블을 나누고 해당 cell에 맞는 값을 할당하는 복잡한 과정이 필요하지만 <code>xtabs</code> 함수를 사용하면 위 과정을 쉽게 수행할 수 있습니다.</p>
<pre class="sourceCode r" id="cb74"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw">head</span>(Fingerprints)</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="kw">tail</span>(Fingerprints)</a>
<a class="sourceLine" id="cb74-3" data-line-number="3"></a>
<a class="sourceLine" id="cb74-4" data-line-number="4">## without xtabs</a>
<a class="sourceLine" id="cb74-5" data-line-number="5">idx &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Fingerprints<span class="op">$</span>count)</a>
<a class="sourceLine" id="cb74-6" data-line-number="6">Fingerprints[idx,]</a>
<a class="sourceLine" id="cb74-7" data-line-number="7">whorls &lt;-<span class="st"> </span><span class="kw">rep</span>(Fingerprints<span class="op">$</span>Whorls[idx], Fingerprints<span class="op">$</span>count[idx])</a>
<a class="sourceLine" id="cb74-8" data-line-number="8">loops &lt;-<span class="st"> </span><span class="kw">rep</span>(Fingerprints<span class="op">$</span>Loops[idx], Fingerprints<span class="op">$</span>count[idx])</a>
<a class="sourceLine" id="cb74-9" data-line-number="9"><span class="kw">table</span>(whorls, loops)</a>
<a class="sourceLine" id="cb74-10" data-line-number="10"></a>
<a class="sourceLine" id="cb74-11" data-line-number="11">## with xtabs</a>
<a class="sourceLine" id="cb74-12" data-line-number="12"><span class="kw">xtabs</span>(count <span class="op">~</span><span class="st"> </span>Whorls <span class="op">+</span><span class="st"> </span>Loops, Fingerprints)</a>
<a class="sourceLine" id="cb74-13" data-line-number="13"><span class="kw">xtabs</span>(count <span class="op">~</span><span class="st"> </span>., Fingerprints)</a></code></pre>
</div>
<div id="graphical-summaries-of-contingency-tables" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Graphical summaries of contingency tables</h3>
<p>테이블 데이터를 가시화 하는 가장 쉬운 방법은 <code>barplot</code> 함수를 이용하는 것 입니다.</p>
<pre class="sourceCode r" id="cb75"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">barplot</span>(seatbelts)</a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="kw">barplot</span>(seatbelts, <span class="dt">beside=</span>T)</a>
<a class="sourceLine" id="cb75-3" data-line-number="3"><span class="kw">barplot</span>(seatbelts, <span class="dt">beside=</span>T, <span class="dt">legend=</span><span class="kw">rownames</span>(seatbelts))</a>
<a class="sourceLine" id="cb75-4" data-line-number="4"><span class="kw">barplot</span>(seatbelts, <span class="dt">beside=</span>T, <span class="dt">legend=</span><span class="kw">rownames</span>(seatbelts), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</a></code></pre>
<p><code>mosaic plot</code>은 <code>barplot</code>을 확장한 개념이나 실제 많이 쓰이진 않습니다. titanic 예제는 타이타닉호에 탑승했던 승객들의 객실 등급과 생존 유무 등을 정리해 놓은 데이터셋 입니다. mosaic plot을 통해서 Sex와 Survived 의 관계를 관측할 수 있으며 이를 확장하여 Class에 대한 분류를 더 하여 정보를 비교할 수 있습니다.</p>
<pre class="sourceCode r" id="cb76"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">titanic &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(Titanic)</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="kw">head</span>(titanic)</a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Survived <span class="op">+</span><span class="st"> </span>Class, <span class="dt">data=</span>titanic, <span class="dt">subset=</span>Sex<span class="op">==</span><span class="st">&quot;Female&quot;</span>)</a>
<a class="sourceLine" id="cb76-4" data-line-number="4"><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Survived <span class="op">+</span><span class="st"> </span>Class, <span class="dt">data=</span>titanic)</a>
<a class="sourceLine" id="cb76-5" data-line-number="5"></a>
<a class="sourceLine" id="cb76-6" data-line-number="6"><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Sex, titanic)</a>
<a class="sourceLine" id="cb76-7" data-line-number="7">tbl &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Survived, titanic)</a>
<a class="sourceLine" id="cb76-8" data-line-number="8"><span class="kw">mosaicplot</span>(tbl)</a>
<a class="sourceLine" id="cb76-9" data-line-number="9">tbl &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Survived <span class="op">+</span><span class="st"> </span>Class, titanic)</a>
<a class="sourceLine" id="cb76-10" data-line-number="10"><span class="kw">mosaicplot</span>(tbl)</a></code></pre>
</div>
<div id="measures-of-association-for-categorical-data" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Measures of association for categorical data</h3>
<p>타이타닉 데이터에서 객실 등급과 생존율의 그룹별 사람수를 보면 다음과 같이 등급별로 생존 비율이 크게 다른 패턴을 가짐을 알 수 있습니다. 이는 두 변수가 서로 상관되어 있음을 의미하는데 비록 이 변수들이 숫자형 변수는 아니지만 자연스럽게 그룹별로 정렬될 수 있고 따라서 그룹별 비율을 비교하므로써 상관성에 대한 유무를 판단할 수 있습니다.</p>
<pre class="sourceCode r" id="cb77"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">mosaicplot</span>(<span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>Class <span class="op">+</span><span class="st"> </span>Survived, <span class="dt">data=</span>titanic))</a></code></pre>
<p>Kendal tau correlation은 concordant/discordant pair를 이용한 정량적 연관성 측정값으로 다음과 같이 계산 할 수 있습니다. 특정 관측 데이터 pair (x1, y1)과 (x2, y2)가 있을 때 x1과 y1이 x2, y2에 비해서 둘 다 높은 (또는 낮은) rank에 위치할 경우 concordant 하다고 하며 반대로 x2 또는 y2 둘 중 하나는 높으나 다른 하나는 낮은 또는 그 반대인 경우 discordant 한 것으로 정의 됩니다. 피어슨 상관성과 같은 -1부터 1사이의 값을 가지며 0은 연관이 전혀 없는 경우를 말합니다.</p>
<p><span class="math display">\[ \tau = \frac{Number ~ of ~ concordant ~ pair - Number ~ of ~ discordant ~ pair}{n(n-1)/2} \]</span></p>
<p>The chi-squared statistics 는 가장 널리 쓰이는 범주형 자료의 연관성 척도로 다음과 같이 정의됩니다. 수식의 “o”와 “e”는 각각 관측값과 예측값을 나타냅니다. 이 값이 클 경우 연관이 크다는 것이고 크고 작음에 대한 검증은 10장에서 다시 다루기로 합니다.</p>
<p><span class="math display">\[ chi-squared ~ statistic = \sum \frac{(f_o - f_e)^2}{f_e} \]</span></p>
<ul>
<li>Example. 다음 seatbelt 데이터에서 괄호를 채우시오. hint: 만약 부모와 아이들의 안전벨트를 매는 두 사건 (변수)가 독립이라면 <span class="math inline">\(p(C, P) == p(C)p(P)\)</span> 즉, 결합확률이 각 확률을 곱한 것과 같고 기대값은 확률 x 전체 사건의 수(<span class="math inline">\(N\)</span>) 이므로 다시 적으면 <span class="math inline">\(N p(C,P) == N p(C)p(P)\)</span>임. 여기서 <span class="math inline">\(N p(C,P)\)</span>는 우리가 관측한 값으로 볼 수 있고 <span class="math inline">\(N p(C) p(P)\)</span>는 독립을 가정한 상태에서 기대값이라고 볼 수 있음.</li>
</ul>
<p><img src="images/03/15.png" /></p>
<pre class="sourceCode r" id="cb78"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">fo &lt;-<span class="st"> </span>tbl</a>
<a class="sourceLine" id="cb78-2" data-line-number="2">fo</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">## marginal probability</a>
<a class="sourceLine" id="cb78-4" data-line-number="4">margin_rows &lt;-<span class="st"> </span><span class="kw">rowSums</span>(fo)<span class="op">/</span><span class="kw">sum</span>(fo)</a>
<a class="sourceLine" id="cb78-5" data-line-number="5">margin_cols &lt;-<span class="st"> </span><span class="kw">colSums</span>(fo)<span class="op">/</span><span class="kw">sum</span>(fo)</a>
<a class="sourceLine" id="cb78-6" data-line-number="6"></a>
<a class="sourceLine" id="cb78-7" data-line-number="7">## expected numbers</a>
<a class="sourceLine" id="cb78-8" data-line-number="8"><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[?]<span class="op">*</span>margin_cols[?]</a>
<a class="sourceLine" id="cb78-9" data-line-number="9"><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[?]<span class="op">*</span>margin_cols[?]</a>
<a class="sourceLine" id="cb78-10" data-line-number="10"><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[?]<span class="op">*</span>margin_cols[?]</a>
<a class="sourceLine" id="cb78-11" data-line-number="11"><span class="kw">sum</span>(fo)<span class="op">*</span>margin_rows[?]<span class="op">*</span>margin_cols[?]</a>
<a class="sourceLine" id="cb78-12" data-line-number="12"></a>
<a class="sourceLine" id="cb78-13" data-line-number="13">## use chisq.test function</a>
<a class="sourceLine" id="cb78-14" data-line-number="14">fe &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(tbl)<span class="op">$</span>expected</a>
<a class="sourceLine" id="cb78-15" data-line-number="15">(fo<span class="op">-</span>fe)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>fe</a>
<a class="sourceLine" id="cb78-16" data-line-number="16"><span class="kw">sum</span>((fo<span class="op">-</span>fe)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>fe)</a></code></pre>
</div>
</div>
<div id="homeworks" class="section level2">
<h2><span class="header-section-number">4.5</span> Homeworks</h2>
<ul>
<li>각 문제의 풀이는 R 코드와 같이 <a href="mailto:haseong@kribb.re.kr">haseong@kribb.re.kr</a> 로 다음 강의시간 전까지 보내주시면 되겠습니다.</li>
</ul>
<div id="hw3-1" class="section level3">
<h3><span class="header-section-number">4.5.1</span> HW3-1</h3>
<ul>
<li>다음 데이터를 <code>age</code> 변수에 저장하고 mean, median, variance 를 구하시오</li>
</ul>
<pre class="sourceCode r" id="cb79"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">{<span class="dv">7</span>,   <span class="dv">9</span>,   <span class="dv">2</span>,  <span class="dv">64</span>,  <span class="dv">41</span>,  <span class="dv">60</span>,  <span class="dv">82</span>,  <span class="dv">31</span>,  <span class="dv">38</span>,  <span class="dv">25</span>,  <span class="dv">52</span>,  <span class="dv">68</span>,  <span class="dv">67</span>}</a></code></pre>
<ul>
<li>위 age 데이터를 z-score로 변환 하고 zage 변수에 저장하시오</li>
<li>age와 zage 두 데이터셋에 대한 각각의 boxplot을 그리고 중간값을 출력하시오</li>
</ul>
<pre class="sourceCode r" id="cb80"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">age &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>,   <span class="dv">9</span>,   <span class="dv">2</span>,  <span class="dv">64</span>,  <span class="dv">41</span>,  <span class="dv">60</span>,  <span class="dv">82</span>,  <span class="dv">31</span>,  <span class="dv">38</span>,  <span class="dv">25</span>,  <span class="dv">52</span>,  <span class="dv">68</span>,  <span class="dv">67</span>)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="kw">mean</span>(age)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3"><span class="kw">median</span>(age)</a>
<a class="sourceLine" id="cb80-4" data-line-number="4"><span class="kw">var</span>(age)</a>
<a class="sourceLine" id="cb80-5" data-line-number="5"></a>
<a class="sourceLine" id="cb80-6" data-line-number="6">zage &lt;-<span class="st"> </span>(age<span class="op">-</span><span class="kw">mean</span>(age))<span class="op">/</span><span class="kw">sd</span>(age)</a>
<a class="sourceLine" id="cb80-7" data-line-number="7">zage</a>
<a class="sourceLine" id="cb80-8" data-line-number="8"><span class="kw">median</span>(age)</a>
<a class="sourceLine" id="cb80-9" data-line-number="9"><span class="kw">median</span>(zage)</a>
<a class="sourceLine" id="cb80-10" data-line-number="10"><span class="kw">boxplot</span>(<span class="kw">data.frame</span>(age, zage))</a>
<a class="sourceLine" id="cb80-11" data-line-number="11"><span class="kw">text</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="kw">median</span>(age))</a>
<a class="sourceLine" id="cb80-12" data-line-number="12"><span class="kw">text</span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="kw">round</span>(<span class="kw">median</span>(zage),<span class="dv">3</span>))</a></code></pre>
</div>
<div id="hw3-2" class="section level3">
<h3><span class="header-section-number">4.5.2</span> HW3-2</h3>
<ul>
<li>UScereal 데이터셋은 미국 식료품점의 선반에 진열된 시리얼 제품의 정보에 대한 데이터임. 시리얼 생산 브랜드와 (UScereal<span class="math inline">\(mfr) 디스플레이되는 floor 층 수 (UScereal\)</span>shelf) 관계를 나타내는 테이블을 구해서 <code>tbl</code> 변수에 저장하고 출력하시오</li>
</ul>
<pre class="sourceCode r" id="cb81"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="kw">head</span>(UScereal)</a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="kw">str</span>(UScereal)</a>
<a class="sourceLine" id="cb81-4" data-line-number="4">?UScereal</a>
<a class="sourceLine" id="cb81-5" data-line-number="5">UScereal<span class="op">$</span>mfr</a></code></pre>
<ul>
<li>브랜드와 진열 층 수와의 관계를 barplot으로 표현하시오</li>
<li>테이블의 각 cell 별 기대값을 구하고 chisqure 값을 구하시오</li>
</ul>
<pre class="sourceCode r" id="cb82"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">tbl &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">table</span>(UScereal<span class="op">$</span>mfr, UScereal<span class="op">$</span>shelf))</a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="kw">barplot</span>(tbl, <span class="dt">beside=</span>T)</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="kw">colSums</span>(tbl)<span class="op">/</span><span class="kw">sum</span>(tbl)</a>
<a class="sourceLine" id="cb82-4" data-line-number="4"><span class="kw">rowSums</span>(tbl)<span class="op">/</span><span class="kw">sum</span>(tbl)</a>
<a class="sourceLine" id="cb82-5" data-line-number="5">tbl</a></code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="univariat-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Rstat.pdf", "Rstat.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
